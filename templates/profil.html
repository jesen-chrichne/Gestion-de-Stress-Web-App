{% extends 'app.html' %}
{% load static %}
    {% block stylesheet %}
    <!--Bootstrap CSS-->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <!--Custom style.css-->
    <link rel="stylesheet" href="{% static 'css/quicksand.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <!--Font Awesome-->
    <link rel="stylesheet" href="{% static 'css/fontawesome-all.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/fontawesome.css' %}">
    <!--Animate CSS-->
    <link rel="stylesheet" href="{% static 'css/animate.min.css' %}">
    <!--Chartist CSS-->
    <link rel="stylesheet" href="{% static 'css/chartist.min.css' %}">
    <!--Map-->
    <link rel="stylesheet" href="{% static 'css/jquery-jvectormap-2.0.2.css' %}">
    <!--Bootstrap Calendar-->
    <link rel="stylesheet" href="{% static 'js/calendar/bootstrap_calendar.css' %}">
    <!--Nice select -->
    <link rel="stylesheet" href="{% static 'css/nice-select.css' %}">
    <style>
        #anyClass {
            height:400px;
            overflow-y: scroll;
          } 
    </style>
    {% endblock stylesheet %}

    {% block title %}Profil{% endblock title %}
        {% block content %}
        <div class="row main-content">
            <!--Sidebar left-->
            <div class="col-sm-3 col-xs-6 sidebar pl-0">
                <div class="inner-sidebar mr-3">
                    <!--Image Avatar-->
                    <div class="avatar text-center">
                        <img src="{{ usr.Image_profil.url }}" alt="" class="rounded-circle" />
                        <p><strong>{{ usr.Nom_Complet }}</strong></p>
                        <span class="text-primary small"><strong>{{ usr.Status }}</strong></span>
                    </div>
                    <!--Image Avatar-->
    
                    <!--Sidebar Navigation Menu-->
                    <div class="sidebar-menu-container">
                        <ul class="sidebar-menu mt-4 mb-4">
                            <li class="parent">
                                <a href="/index_app" class=""><i class="fa fa-rocket mr-3"> </i>
                                    <span class="none">Acceuil</span>
                                </a>  
                            </li>
                            <li class="parent">
                                <a href="/profil" class=""><i class="fas fa-user mr-3"> </i>
                                    <span class="none">Mon profil</span>
                                </a>  
                            </li>
                            <li class="parent">
                                <a href="/journal_app" class=""><i class="fas fa-book mr-3"> </i>
                                    <span class="none">Journal</span>
                                </a>  
                            </li>
                            <li class="parent">
                                <a href="/manage_stress_app" class=""><i class="fas fa-smile mr-3"></i>
                                    <span class="none">Gestion de stress</span>
                                </a>
                            </li>
                            <li class="parent">
                                <a href="/ressource_app" class=""><i class="fas fa-database mr-3"></i>
                                    <span class="none">Ressource</span>
                                </a>
                            </li>
                            {% if usr.Status == 'Psychologue' %}
                            <li class="parent">
                                <a href="/assistance" class=""><i class="fas fa-envelope mr-3"></i>
                                    <span class="none">Messagerie</span>
                                </a>
                            </li>
                            {% else %}
                            <li class="parent">
                                <a href="/chat" class=""><i class="fas fa-comments mr-3"></i>
                                    <span class="none">Chat</span>
                                </a>
                            </li>
                            {% endif %}

                            <li class="parent">
                                <a href="/logout" class=""><i class="fas fa-power-off mr-3"></i>
                                    <span class="none">Déconnexion</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <!--Sidebar Naigation Menu-->
                </div>
            </div>

            <div class="col-sm-9 col-xs-12 content pt-3 pl-0">
                <div class="row mt-3">
                    <div class="col-sm-12">
                        <!--User profile header-->
                        <div class="mt-1 mb-3 button-container bg-white border shadow-sm">
                            <div class="profile-bg p-5">
                                <img src="{{ usr.Image_profil.url }}" height="125px" width="125px" class="rounded-circle shadow profile-img" />
                            </div>
                            <div class="profile-bio-main container-fluid">
                                <div class="row">
                                    <div class="col-md-5 offset-md-3 col-sm-12 offset-sm-0 col-12 bio-header">
                                        <h3 class="mt-4">{{ usr.Nom_Complet }}</h3>
                                        <span class="text-muted mt-0 bio-request">{{ usr.Fonction }}</span>
                                    </div>
                                    <div class="col-md-4 col-sm-12 col-12 px-5 text-right pt-4 bio-comment">
                                        <button class="btn btn-outline-info btn-round" data-toggle="modal" data-target="#myModal">
                                            <i class="fas fa-edit mr-3"></i> Modifier mon profil
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--/User profile header-->
                    </div>
                </div>

                <div class="row mt-3">
                    <!--User profile sidebar-->
                    <div class="col-sm-12 col-md-4">
                        <div class="mt-1 mb-3 p-3 button-container bg-white border shadow-sm">
                            
                            <div class="mb-3 text-center">
                                <h3><i class="fa fa-file-text-o"></i> Infos</h3>
                            </div>
                            
                            <div class="dropdown-divider"></div>
                            
                            <div class="table-responsive mb-3">
                                <table class="table table-borderless table-striped m-0">
                                    <tbody>
                                        <tr>
                                            <th scope="row">Nom Complet</th>
                                            <td>{{ usr.Nom_Complet }}</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Age</th>
                                            <td>{{ usr.Age }}</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Email</th>
                                            <td>{{ usr.Email }}</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Département</th>
                                            <td>{{ usr.Departement }}</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Fonction</th>
                                            <td>{{ usr.Fonction }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                <!--User profile content-->
                <div class="col-sm-12 col-md-8" id="anyClass">
                    <div class="mt-1 mb-3 p-3 button-container bg-white border shadow-sm custom-tabs">
                        
                        <nav>
                            <div class="nav nav-tabs nav-fill" id="nav-customContent" role="tablist">
                                <a class="nav-item nav-link active" id="nav-home" data-toggle="tab" href="#custom-home" role="tab" aria-controls="nav-home" aria-selected="true">
                                        <i class="fa fa-list-ul"></i> Publication
                                </a>
                            </div>
                        </nav>

                        <div class="tab-content py-3 px-3 px-sm-0" id="nav-customContent">
                            <div class="tab-pane fade show active p-4" id="custom-home" role="tabpanel" aria-labelledby="nav-home">
                                {% for post in pub %}
                                <!--Single feed-->
                                <div class="feed-single mb-3">
                                    <div class="media">
                                        <img class="mr-3 rounded-circle" height="40px" width="40px" src="{{ post.Auteur_pub.Image_profil.url }}">
                                        <div class="media-body">
                                            <h6 class="mt-1">{{ post.Auteur_pub.Nom_Complet }}
                                                <small class="text-muted pl-2"><i class="fa fa-clock"></i>{{ post.Date_pub }}</small>
                                                <small class="text-muted small pull-right"><i>{{ post.Auteur_pub.Fonction }}</i> <i class="fa fa-bookmark-o pl-2"></i></small>
                                                <br>
                                            </h6>
                                            <div>                                    
                                                {% if post.Fichier %}
                                                <img class="card-img-top" src="{{ post.Fichier.url }}">
                                                {% else %}
                                                {% endif %}
                                            </div>
                                            <h5 class="mt-1">{{ post.Titre }}</h5>
                                            <p>{{ post.Contenu }}</p>

                                            <div class="feed-footer">
                                                <span class="pr-3">
                                                    <a href="#"><i class="fas fa-heart"></i> {{ post.Like.count }}</a></span>
                                                <span class="pr-3">
                                                    <a href="/details_pub/{{ post.id }}"><i class="fa fa-comment"></i> Voir Commentaires</a>
                                                </span>

                                                <p class="clearfix"></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--/Single feed-->

                                <div class="dropdown-divider"></div>
                                {% endfor %}
                            </div>
                            <!--/Feed tab-->
                        </div>
                    </div>
                </div>

            </div>

            <div class="modal fade" id="myModal">
                <div class="modal-dialog modal-dialog-centered modal-lg">
                    <div class="modal-content">
              
                        <!-- Modal Header -->
                        <div class="modal-header">
                            <h3>Modifier mes infos</h3>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>
              
                        <!-- Modal body -->
                        <div class="modal-body">
                            <form class="form-horizontal mt-4 mb-5" method="post" action="{% url 'update_user_app' usr.id %}" enctype="multipart/form-data">
                                {%  csrf_token %}
                                {% comment %} <div class="form-group row">
                                    <label for="Image_Profil" class="control-label col-sm-2">Photo de Profil</label>
                                    <div class="col-sm-8">
                                        <input type="file" name="Image_Profil" accept="image/*" onchange="loadFile(event)" required >
                                    </div>
                                    <img id="output" src="{% static 'img/default-avatar.jpg' %}" class="rounded-circle" width="100" height="100" />
                                </div> {% endcomment %}

                                <div class="form-group row">
                                    <label for="Nom" class="control-label col-sm-2">Nom Complet</label>
                                    <div class="col-sm-10">
                                        <input type="text" name="Nom" class="form-control" value="{{ usr.Nom_Complet }}" />
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="Age" class="control-label col-sm-2">Age</label>
                                    <div class="col-sm-10">
                                        <input type="number" name="Age" class="form-control" value="{{ usr.Age }}" min="15" max="85" />
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="Email" class="control-label col-sm-2">Email</label>
                                    <div class="col-sm-8">
                                        <input type="email" name="Email" class="form-control" value="{{ usr.Email }}" />
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="Departement" class="control-label col-sm-2">Département</label>
                                    <div class="col-sm-10">
                                        <input type="text" name="Departement" class="form-control" value="{{ usr.Departement }}" />
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="Fonction" class="control-label col-sm-2">Fonction</label>
                                    <div class="col-sm-10">
                                        <input type="text" name="Fonction" class="form-control" value="{{ usr.Fonction }}" />
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="Username" class="control-label col-sm-2">Nom d'utilisateur</label>
                                    <div class="col-sm-10">
                                        <input type="text" name="Username" class="form-control" value="{{ usr.Username }}" />
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="Password" class="control-label col-sm-2">Mot de passe</label>
                                    <div class="col-sm-10">
                                        <input type="text" name="Password" class="form-control" value="{{ usr.Password }}"/>
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <div class="offset-sm-2 col-sm-9">
                                        <input type="submit" class="btn btn-success" value="Modifier">
                                        <button type="button" class="btn btn-danger" data-dismiss="modal">Annuler</button>
                                    </div>
                                </div>

                            </form>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        {% endblock content %}
        

    <!--Page Wrapper-->
    {% block script %}
    <script>
        var loadFile = function(event) {
            var output = document.getElementById('output');
            output.src = URL.createObjectURL(event.target.files[0]);
            output.onload = function() {
              URL.revokeObjectURL(output.src) // free memory
            }
          };
    </script>
    <!-- Page JavaScript Files-->
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'js/jquery-1.12.4.min.js' %}"></script>
    <!--Popper JS-->
    <script src="{% static 'js/popper.min.js' %}"></script>
    <!--Bootstrap-->
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <!--Sweet alert JS-->
    <script src="{% static 'js/sweetalert.js' %}"></script>
    <!--Progressbar JS-->
    <script src="{% static 'js/progressbar.min.js' %}"></script>
    <!--Flot.JS-->
    <script src="{% static 'js/charts/jquery.flot.min.js' %}"></script>
    <script src="{% static 'js/charts/jquery.flot.pie.min.js' %}"></script>
    <script src="{% static 'js/charts/jquery.flot.categories.min.js' %}"></script>
    <script src="{% static 'js/charts/jquery.flot.stack.min.js' %}"></script>
    <!--Chart JS-->
    <script src="{% static 'js/charts/chart.min.js' %}"></script>
    <!--Chartist JS-->
    <script src="{% static 'js/charts/chartist.min.js' %}"></script>
    <script src="{% static 'js/charts/chartist-data.js' %}"></script>
    <script src="{% static 'js/charts/demo.js' %}"></script>
    <!--Maps-->
    <script src="{% static 'js/maps/jquery-jvectormap-2.0.2.min.js' %}"></script>
    <script src="{% static 'js/maps/jquery-jvectormap-world-mill-en.js' %}"></script>
    <script src="{% static 'js/maps/jvector-maps.js' %}"></script>
    <!--Bootstrap Calendar JS-->
    <script src="{% static 'js/calendar/bootstrap_calendar.js' %}"></script>
    <script src="{% static 'js/calendar/demo.js' %}"></script>
    <!--Nice select-->
    <script src="{% static 'js/jquery.nice-select.min.js' %}"></script>

    <!--Custom Js Script-->
    <script src="{% static 'js/custom.js' %}"></script>
    <!--Custom Js Script-->
    <script>
        //Nice select
        $('.bulk-actions').niceSelect();
    </script>
    {% endblock script %}